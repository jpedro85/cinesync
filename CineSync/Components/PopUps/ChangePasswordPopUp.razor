@rendermode InteractiveServer

@using CineSync.Components.Buttons

<PopUpLayout @ref="PopUpLayout" Id="changePasswordPopUp">
    <Header>
        <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="40" height="40" viewBox="0 0 64 64">
            <path d="M 31 0 C 20.523438 0 12 8.523438 12 19 L 12 24 L 9 24 C 7.347656 24 6 25.347656 6 27 L 6 57 C 6 58.652344 7.347656 60 9 60 L 55 60 C 56.652344 60 58 58.652344 58 57 L 58 27 C 58 25.347656 56.652344 24 55 24 L 52 24 L 52 19 C 52 8.523438 43.476563 0 33 0 Z M 31 2 L 33 2 C 33.339844 2 33.667969 2.03125 34 2.050781 L 34 6.050781 C 33.667969 6.023438 33.339844 6 33 6 L 31 6 C 30.660156 6 30.332031 6.023438 30 6.050781 L 30 2.050781 C 30.332031 2.03125 30.660156 2 31 2 Z M 28 2.28125 L 28 6.363281 C 22.277344 7.722656 18 12.867188 18 19 L 18 24 L 14 24 L 14 19 C 14 10.652344 20.054688 3.703125 28 2.28125 Z M 36 2.28125 C 43.945313 3.703125 50 10.652344 50 19 L 50 24 L 46 24 L 46 19 C 46 12.867188 41.722656 7.722656 36 6.363281 Z M 31 8 L 33 8 C 39.066406 8 44 12.933594 44 19 L 44 24 L 20 24 L 20 19 C 20 12.933594 24.933594 8 31 8 Z M 9 26 L 55 26 C 55.550781 26 56 26.449219 56 27 L 56 57 C 56 57.550781 55.550781 58 55 58 L 9 58 C 8.449219 58 8 57.550781 8 57 L 8 27 C 8 26.449219 8.449219 26 9 26 Z M 41.921875 31 C 41.53125 31.03125 41.183594 31.289063 41.050781 31.683594 C 40.875 32.207031 41.160156 32.773438 41.683594 32.949219 L 44 33.71875 L 44 39 L 43 39 C 42.449219 39 42 39.445313 42 40 C 42 40.554688 42.449219 41 43 41 L 44 41 L 44 46.28125 L 41.683594 47.050781 C 41.160156 47.226563 40.878906 47.792969 41.050781 48.316406 C 41.191406 48.734375 41.582031 49 42 49 C 42.105469 49 42.210938 48.980469 42.316406 48.949219 L 45 48.054688 L 47.683594 48.949219 C 47.789063 48.984375 47.894531 49 48 49 C 48.417969 49 48.808594 48.734375 48.949219 48.316406 C 49.125 47.792969 48.839844 47.226563 48.316406 47.050781 L 46 46.28125 L 46 41 L 47 41 C 47.550781 41 48 40.554688 48 40 C 48 39.445313 47.550781 39 47 39 L 46 39 L 46 33.71875 L 48.316406 32.949219 C 48.839844 32.773438 49.121094 32.207031 48.949219 31.683594 C 48.773438 31.160156 48.210938 30.875 47.683594 31.050781 L 45 31.945313 L 42.316406 31.050781 C 42.183594 31.007813 42.050781 30.992188 41.921875 31 Z M 18 38 C 16.894531 38 16 38.894531 16 40 C 16 41.105469 16.894531 42 18 42 C 19.105469 42 20 41.105469 20 40 C 20 38.894531 19.105469 38 18 38 Z M 27 38 C 25.894531 38 25 38.894531 25 40 C 25 41.105469 25.894531 42 27 42 C 28.105469 42 29 41.105469 29 40 C 29 38.894531 28.105469 38 27 38 Z M 36 38 C 34.894531 38 34 38.894531 34 40 C 34 41.105469 34.894531 42 36 42 C 37.105469 42 38 41.105469 38 40 C 38 38.894531 37.105469 38 36 38 Z M 11 54 C 10.449219 54 10 54.445313 10 55 C 10 55.554688 10.449219 56 11 56 L 45 56 C 45.550781 56 46 55.554688 46 55 C 46 54.445313 45.550781 54 45 54 Z M 49 54 C 48.449219 54 48 54.445313 48 55 C 48 55.554688 48.449219 56 49 56 L 53 56 C 53.550781 56 54 55.554688 54 55 C 54 54.445313 53.550781 54 53 54 Z"></path>
        </svg>
        <div class="title prevent-select" style="color:white; font-size:30px;">Change Password</div>
    </Header>
    <Body>
    <div class="main-container">
        @if (!string.IsNullOrEmpty(message))
        {
            var statusMessageClass = message.StartsWith("Error") ? "danger" : "success";
            <div class="alert alert-@statusMessageClass" role="alert">
                @message
            </div>
        }
        <EditForm Model="Input" FormName="change-password" OnValidSubmit="OnValidSubmitAsync" method="post">
            <DataAnnotationsValidator/>
            <ValidationSummary class="text-danger" role="alert"/>
            <div class="form-floating mb-3">
                <span class="form-label">Old password</span>
                <InputText type="password" @oninput="ClearMessage" @bind-Value="Input.OldPassword" class="form-control" autocomplete="current-password" aria-required="true" placeholder="Please enter your old password."/>
                <ValidationMessage For="() => Input.OldPassword" class="text-danger"/>
            </div>
            <div class="form-floating mb-3">
                <span class="form-label">New password</span>
                <InputText type="password" @oninput="ClearMessage" @bind-Value="Input.NewPassword" class="form-control" autocomplete="new-password" aria-required="true" placeholder="Please enter your new password."/>
                <ValidationMessage For="() => Input.NewPassword" class="text-danger"/>
            </div>
            <div class="form-floating mb-3">
                <span class="form-label">Confirm password</span>
                <InputText type="password" @oninput="ClearMessage" @bind-Value="Input.ConfirmPassword" class="form-control" autocomplete="new-password" aria-required="true" placeholder="Please confirm your new password."/>
                <ValidationMessage For="() => Input.ConfirmPassword" class="text-danger"/>
            </div>
        </EditForm>
    </div>
    </Body>
    <Footer>
        <RectButton2 Text="Cancel" OnClick="PopUpLayout.Close" />
        <RectButton1 Text="Update Password" OnClick="async ()=> await OnValidSubmitAsync()" />
    </Footer>
</PopUpLayout>